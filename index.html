<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MindAR Image Tracking</title>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.1.0/dist/mindar-image-three.prod.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
      body {
        margin: 0;
        overflow: hidden;
      }
      canvas {
        display: block;
      }
    </style>
  </head>
  <body>
    <div id="container"></div>
    <script>
      document.addEventListener("DOMContentLoaded", async () => {
        const mindarThree = new MindAR.Three.MindARThree({
          container: document.querySelector("#container"),
          imageTargetSrc: "./marker.mind", // 你的 marker 設定檔
          uiScanning: "yes",
          maxTrack: 1, // 允許最多追蹤 1 個目標
        });

        const { renderer, scene, camera } = mindarThree;

        const anchor = mindarThree.addAnchor(0);

        // 確保 WebAR 會請求開啟相機
        await mindarThree.start();

        // 加載圖片紋理
        const textureLoader = new THREE.TextureLoader();
        const texture = textureLoader.load("./success-image.png"); // 這裡換成你的圖片

        // 建立平面並貼上圖片
        const geometry = new THREE.PlaneGeometry(1, 1);
        const material = new THREE.MeshBasicMaterial({
          map: texture,
          transparent: true,
        });
        const plane = new THREE.Mesh(geometry, material);

        anchor.group.add(plane); // 把圖片加到掃描成功後的畫面中

        renderer.setAnimationLoop(() => {
          renderer.render(scene, camera);
        });
      });
    </script>
  </body>
</html>
